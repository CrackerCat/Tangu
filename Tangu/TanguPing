#pragma once
#ifndef _TANGU_PING
#define _TANGU_PING

#include "TanguAnalyzer"

class PacketGrouper : protected NetInfo
{
private:
	ICMP	_ICMPPacket;
	
public:
	PacketGrouper::PacketGrouper(pcap_t** Interface, Net::IPInfo Target)
		: NetInfo(Interface)
	{
		_ICMPPacket._Rsrc.IDst = Target;
		Net::Utility::GetIPAddress(_ICMPPacket._Rsrc.ISrc);
		Net::Utility::GetMACAddress(_ICMPPacket._Rsrc.MSrc);

		Net::Utility::GetGatewayIPAddress(_ARPFrame._Rsrc.IDst);
		_ICMPPacket._Rsrc.MDst = _ARPFrame._Rsrc.MDst = CollectNetworkInfo(_ARPFrame._Rsrc.IDst, 30.0);
	}
	void PacketGrouper::Ping(ICMPArchitecture::ICMPType Type)
	{
		_ICMPPacket.GetICMP(Type);
		pcap_sendpacket(*_Interface, _ICMPPacket._Msg, sizeof(EthernetHeader) + sizeof(IPHeader) + sizeof(ICMPArch));
	}
};

#endif /* _TANGU_PING */